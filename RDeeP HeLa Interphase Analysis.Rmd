---
title: "RDeep HeLa Interphase Analysis"
author: "Laura Herrfurth"
date: "8 5 2022"
output: html_document
---

```{r}
#Load data RDeep_HeLa_Interphase 
data = read.table("C:/Users/Laura Herrfurth/Documents/Data Analysis Projekt/RDeeP_HeLa_Interphase.csv",header = TRUE, row.names = 1, sep = ";")


#First survey
head(data)
summary(data)
dim(data)
colnames(data)
rownames(data)

sapply(data,mode)

```

The data contains 7086 proteins and 25 fractions which were each repeated three times as a control sample and three times with RNAse.

After the first survey we have to find a way to deal with the missing values in the data.The options are to remove rows (proteins) with a very high count or to replace all missing values with the mean of the general count of a specific protein of the control or the RNAse sample.


```{r}

# missing values have the value 0 -> delete these values or replace them directly
#First option: deleting rows with NA (questionable!)
which(data == 0)
data_rm = data[-which(data == 0),]
dim(data_rm)
head(data_rm)

#Sum missing values in each row -> no NA 
na = apply(data_rm,1,function(x){sum(is.na(x))})
na
summary(na)

#Second option: replacing missing values
colRep1ctrl = seq(1, 150, 6) ##alle Columns die rep1 ctrl enthalten
colRep2ctrl = seq(2, 150, 6) ##alle Columns die rep2 ctrl enthalten
colRep3ctrl = seq(3, 150, 6) ##alle Columns die rep3 ctrl enthalten

colRep1RNAse = seq(4, 150, 6) ##alle Columns die rep1 RNAse enthalten
colRep2RNAse = seq(5, 150, 6) ##alle Columns die rep2 RNAse enthalten
colRep3RNAse = seq(6, 150, 6) ##alle Columns die rep3 RNAse enthalten


#Irgendwie mean der Reps berechnen ?? for schleife? 
# Irgendwie noch weird und funktioniert nicht
# Idee war immer die Werte eines Reps zu addieren und den mean davon zu bilden
y = 1:25

meanRep=0
for (i in y){
  i
  c(meanRep,(data(colRep1ctrl[y]) + data(colRep2ctrl[y]) + data(colRep3ctrl[y]))/ 3)
}
  
meanRep = (data(colRep1ctrl[y]) + data(colRep2ctrl[y]) + data(colRep3ctrl[y]) )/ 3



#Argument weder numerisch noch boolesch? hä? warum? Gibt nur NA an
apply(data[,1:3],1,mean) #mean for first fractions

#mean in general
a = y + 3
b = y + 3
apply(data[,a:b], 1, mean)



#replacing missing values for first fraction
mean_1 = apply(data[1:3,],2,mean)
data[is.na(data[])== TRUE]
apply(data[1:3],2,function(x){(is.na(x)== TRUE) = mean_1})


```
After deleting values or replacing values we have to examine differences in the different samples and to illustrate them. We are looking at the plots of single proteins and compare the lines and maxima of the control and the RNAse group. 

```{r}
#Plots for fractions of each gene
# Warning for 'NAs introduced by coercion' (?)
for (i in 4200:4300){
plot(y, data[i,colRep1ctrl], col = "blue", xlab = i) ##plot des Rep1 ctrl sample für protein 1
lines(y, data[i,colRep2ctrl], col = "blue") ##plot des Rep2 ctrl sample für protein 1
lines(y, data[i,colRep3ctrl], col = "blue") ##plot des Rep3 ctrl sample für protein 1

lines(y, data[i,colRep1rnase], col = "pink")
lines(y, data[i,colRep2rnase], col = "pink")
lines(y, data[i,colRep3rnase], col = "pink")
}

##examples of shifts or differences in maxima; abnormalities
for (i in c(4148,4150:4154, 4189,4190, 4293 )){
plot(y, data[i,colRep1ctrl], col = "blue", xlab = i) ##plot des Rep1 ctrl sample für protein 1
lines(y, data[i,colRep2ctrl], col = "blue") ##plot des Rep2 ctrl sample für protein 1
lines(y, data[i,colRep3ctrl], col = "blue") ##plot des Rep3 ctrl sample für protein 1

lines(y, data[i,colRep1rnase], col = "pink")
lines(y, data[i,colRep2rnase], col = "pink")
lines(y, data[i,colRep3rnase], col = "pink")
}


```
These are some proteins that were selected from the interval of protein 4000 until protein 4300. Their maxima of the plot of the control and RNAse group show differences to each other. These differences of these examples have to get examined further.