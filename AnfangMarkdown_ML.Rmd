---
title: "RDeeP_HeLa_Interphase"
author: "MSalein"
date: "23 5 2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

load data set

```{r}
FullDat <- read.table("C:/Dokumente/Uni/FS 4/Data Analysis/RDeeP_HeLa_Interphase.csv", header = TRUE, row.names=1, sep = ";") 
```



testing if all values are numeric (here doubles)
```{r}
apply(FullDat, 2, is.double)
```
all values are stored as doubles


alle Zeilen, die nur 0 enthalten, entfernen
0 in NA übersetzen which reduces the data set from 7086 to 8085 rows

```{r}
which(rowSums(FullDat==0)==150) ##welche Proteine haben nur 0 in der Zeile?
FullDat = FullDat[-(which(rowSums(FullDat==0)==150)),]


FullDat[FullDat==0] = NA ##würde ich rausnehmen und nur für mean und co vllt einbauen (aplly hat kein rm.na!!!)

```

Aufteilen auf kleinere Datensätze (1 für jedes Replikat)
```{r}
colRep1ctrl = seq(1, 150, 6) ##all columns with measurements from rep1 control sample 
colRep2ctrl = seq(2, 150, 6) ##all columns with measurements from rep2 control sample
colRep3ctrl = seq(3, 150, 6) ##all columns with measurements from rep3 control sample
colRep1rnase = seq(4, 150, 6) ##all columns with measurements from rep1 rnase sample
colRep2rnase = seq(5, 150, 6) ##all columns with measurements from rep2 rnase sample
colRep3rnase = seq(6, 150, 6) ##all columns with measurements from rep3 rnase sample

all_colrep = matrix(c(colRep1ctrl, colRep2ctrl, colRep3ctrl, colRep1rnase, colRep2rnase, colRep3rnase), byrow = TRUE, nrow = 6)

rep1ctrldat = FullDat[,colRep1ctrl] 
rep2ctrldat = FullDat[,colRep2ctrl]
rep3ctrldat = FullDat[,colRep3ctrl]
rep1rnasedat = FullDat[,colRep1rnase]
rep2rnasedat = FullDat[,colRep2rnase]
rep3rnasedat = FullDat[,colRep3rnase]
```

Data set für ctrl und rnase

```{r}
TripCtrldat = cbind(rep1ctrldat, rep2ctrldat, rep3ctrldat)
TripRnasedat = cbind(rep1rnasedat, rep2rnasedat, rep3rnasedat)
```

removing all rows that have all NA aka 0 in either control or rnase thus no comparison possible (from Full data set and from trip control and rnase) 
resulting data sets contain 7081 rows
```{r}
FullDat = FullDat[-which(rowSums(is.na(TripCtrldat))==75),]
FullDat = FullDat[-which(rowSums(is.na(TripRnasedat))==75),]
rTripCtrldat = TripCtrldat[-which(rowSums(is.na(TripCtrldat))==75),]
rTripCtrldat = rTripCtrldat[-which(rowSums(is.na(TripRnasedat))==75),]
rTripRnasedat = TripRnasedat[-which(rowSums(is.na(TripCtrldat))==75),]
rTripRnasedat = rTripRnasedat[-which(rowSums(is.na(TripRnasedat))==75),]

rrep1ctrldat = rTripCtrldat[,1:25]
rrep2ctrldat = rTripCtrldat[,26:50]
rrep3ctrldat = rTripCtrldat[,51:75]

rrep1rnasedat = rTripRnasedat[,1:25]
rrep2rnasedat = rTripRnasedat[,26:50]
rrep3rnasedat = rTripRnasedat[,51:75]

##warum funktioniet das nicht
##remo = function(x){x = x[-which(rowSums(is.na(TripCtrldat))==75),]}
##remo(FullDat)

```

Normalisierung auf 100
reps transponieren (funktion definieren? damit nicht alles 100 mal eingeben)
dann auf 100

```{r}
FullDat[is.na(FullDat)] = 0
rep1ctrlnormData = t(apply(FullDat[, colRep1ctrl], 1, function(x) x/(sum(x)/100)))
rep2ctrlnormData = t(apply(FullDat[, colRep2ctrl], 1, function(x) x/(sum(x)/100)))
rep3ctrlnormData = t(apply(FullDat[, colRep3ctrl], 1, function(x) x/(sum(x)/100)))
rep1rnasenormData = t(apply(FullDat[, colRep1rnase], 1, function(x) x/(sum(x)/100)))
rep2rnasenormData = t(apply(FullDat[, colRep2rnase], 1, function(x) x/(sum(x)/100)))
rep3rnasenormData = t(apply(FullDat[, colRep3rnase], 1, function(x) x/(sum(x)/100)))

rep1ctrlnormDataframe = as.data.frame(rep1ctrlnormData)
rep2ctrlnormDataframe = as.data.frame(rep2ctrlnormData)
rep3ctrlnormDataframe = as.data.frame(rep3ctrlnormData)
rep1rnasenormDataframe = as.data.frame(rep1rnasenormData)
rep2rnasenormDataframe = as.data.frame(rep2rnasenormData)
rep3rnasenormDataframe = as.data.frame(rep3rnasenormData)


sum(rep1ctrlnormData[1,]) # == 100


#mean of control replicates of all proteins  
meanRepctrl = matrix(nrow= nrow(FullDat), ncol = 25)
for (j in 1:nrow(FullDat)){ 
  for (i in 1:25){
    meanRepctrl[j,i] = (rep1ctrlnormDataframe[j,i] + rep2ctrlnormDataframe[j,i] + rep3ctrlnormDataframe[j,i])/3}}

#mean of rnase replicates of all proteins 
meanRepRNase = matrix(nrow= nrow(FullDat), ncol = 25)
for (j in 1:nrow(FullDat)){ 
  for (i in 1:25){
    meanRepRNase[j,i] = (rep1rnasenormDataframe[j,i] + rep2rnasenormDataframe[j,i] + rep3rnasenormDataframe[j,i])/3}}


```

Plot normalized mean for ctrl and rnase 
```{r}
y = 1:25
f = (function(x)plot(y,x, type ="o", pch = 20))
plot_ctrl = apply(meanRepctrl[1:10,],1,f)
plot_rnase = apply(meanRepRNase[1:10,],1,f)

```
Plot both of them in one graph

```{r}
for (i in 1:10){
  plot(y, meanRepctrl[i,], type ="o", pch = 20, ylab = "percentage of protein amount", xlab = "fractions of sucrose density gradient")
  lines(y,meanRepRNase[i,], type = "o", pch = 20)
}
```

